{"name":"Repeat.js","tagline":"Timed actions in JavaScript simplified","body":"<pre>\r\n ____                                     __\r\n/\\  _`\\                                  /\\ \\__       __\r\n\\ \\ \\L\\ \\     __   _____      __     __  \\ \\ ,_\\     /\\_\\    ____\r\n \\ \\ ,  /   /'__`\\/\\ '__`\\  /'__`\\ /'__`\\ \\ \\ \\/     \\/\\ \\  /',__\\\r\n  \\ \\ \\\\ \\ /\\  __/\\ \\ \\L\\ \\/\\  __//\\ \\L\\.\\_\\ \\ \\_  __ \\ \\ \\/\\__, `\\\r\n   \\ \\_\\ \\_\\ \\____\\\\ \\ ,__/\\ \\____\\ \\__/.\\_\\\\ \\__\\/\\_\\_\\ \\ \\/\\____/\r\n    \\/_/\\/ /\\/____/ \\ \\ \\/  \\/____/\\/__/\\/_/ \\/__/\\/_/\\ \\_\\ \\/___/\r\n                     \\ \\_\\                           \\ \\____/\r\n                      \\/_/                            \\/___/\r\n\r\nTimed actions in JavaScript simplified\r\n</pre>\r\n\r\n[![Build Status](https://secure.travis-ci.org/bjoerge/repeat.js.png)](http://travis-ci.org/bjoerge/repeat.js)\r\n\r\n# Summary\r\nRepeat.js is a tiny (< 2kb minified and gzipped) javascript library for timing function calls.\r\n\r\n- It abstracts away the need for dealing with setTimeout and setInterval, and the somewhat error prone timer and interval IDs\r\n\r\n- It provides an simple, intuitive and flexible chained api.\r\n\r\n- It is ideal for polling, performing asynchronous updates, doing timed UI updates or executing expensive tasks asynchronously .\r\n\r\n- It can be used standalone or with jQuery.\r\n\r\n- It is built on top of a Deferred/promise implemetation for even greater flexibility\r\n\r\n- It is tested in IE 7-9, Firefox 10, Chrome 16, Safari 5.1 and Opera 11.61.\r\n\r\n## Examples\r\n\r\nYou may also fool around with [ Repeat.js in jsFiddle](http://jsfiddle.net/bjoerge/c7KqT/)\r\n\r\n### Basic example\r\n```javascript\r\nfunction sayHello() {\r\n  console.log(\"Hello world!\");\r\n};\r\n\r\nRepeat(sayHello).every(500, 'ms').for(2, 'minutes').start.in(2, 'sec');\r\n// -> Now wait for 2 seconds and keep a watchful eye on the javascript console\r\n```\r\n\r\n### Live display of relative time with jQuery and moment.js\r\n\r\n```javascript\r\njQuery(function() {\r\n  (function mockDOM() { // This is just for creating some example DOM elements\r\n    var ul = jQuery(\"<ul></ul>\"), now = (new Date().getTime()), elem_count = 100;\r\n    while (elem_count--) {;\r\n      ul.append(jQuery('<li class=\"live-time\" data-timestamp=\"'+\r\n         (now+(Math.random()*100000)*(Math.random() > 0.5 ? -1 : 1)) +\r\n        '\"></li>'))\r\n    }\r\n    ul.appendTo(jQuery(\"body\")); \r\n  }());\r\n\r\n  var elems = jQuery(\".live-time\");\r\n  Repeat(function() {\r\n    elems.each(function(i, elem) {\r\n      elem = jQuery(elem);\r\n      var time = moment(elem.data(\"timestamp\"));\r\n      elem.html('Displaying '+ time.format(\"dddd, MMMM Do YYYY, h:mm:ss a\") +' as \"<b>'+ time.fromNow()+'</b>\"');\r\n    });\r\n  }).every(1000, 'ms').start.now();\r\n});\r\n```\r\n\r\n### Asynchronous polling with jQuery \r\n\r\nPolling a server every second, but wait for the request to complete before proceeding\r\n\r\n```javascript\r\n\r\nRepeat(function(done) {\r\n         jQuery.ajax({\r\n           url: 'http://www.example.com',\r\n           success: function(data) {console.log(data);},\r\n           complete: function() {\r\n             done(); // will wait for this to be called before continuing\r\n           }\r\n         });\r\n       })\r\n       .every(1000, 'ms')\r\n       .for(2, 'minutes')\r\n       .start.in(3, 'secs');\r\n```\r\n\r\n### Monitoring changes in an objects' state with console.monitor\r\n\r\nAdd a function to the console object, that allows for monitoring a property of any object.\r\n\r\n```javascript\r\nconsole.monitor = function(object, property) {\r\n  var last_value = object[property];\r\n  return Repeat(function() {\r\n    var current_value = object[property];\r\n    if (last_value !== current_value) {\r\n      console.log('Property changed from \"'+last_value+'\" to \"'+current_value+'\"!');\r\n      last_value = current_value;\r\n    }\r\n    else {\r\n      console.log(\"No change\");\r\n    }\r\n  });\r\n};\r\n\r\nvar myObject = {someProperty: \"Something\"};\r\nconsole.monitor(myObject, 'someProperty').every(500, 'ms').for(10, 'seconds').start();\r\nsetTimeout(function() {myObject.someProperty = \"Changed value\"}, 3000);\r\n```\r\n\r\n### Execute expensive operations asynchronously\r\nA common trick in order to keep the UI responsive while executing expensive operations\r\nis to split up the parts of the operation into smaller subtasks that can be executed asynchronously using timers.\r\n\r\nThe illustrating example from Nicholas C. Zakas' High Performance Javascript (loc. 3215) could be rewritten like this:\r\n\r\n```javascript\r\nfunction saveDocument(id) {\r\n  var tasks = [openDocument, writeText, closeDocument, updateUI]; // these are the expensive functions\r\n  return Repeat(function() {\r\n      var task = tasks.shift();\r\n      task(id);\r\n    })\r\n    .async().until(function() {\r\n      return tasks.length == 0;\r\n    }).start.now();        \r\n}\r\n```\r\n\r\n# Promise support\r\nThe functions `start()` `now()` `in()` and `wait()` will all return a read-only [Promise](http://en.wikipedia.org/wiki/Futures_and_promises) instance.\r\n\r\n- If used with jQuery, it will return an instance of jQuery's [Promise](http://api.jquery.com/Types/#Promise).\r\n- If used standalone, a [minimalistic](https://github.com/bjoerge/dfrrd.js) implementation of the CommonJS [Promises/A](http://wiki.commonjs.org/wiki/Promises/A) spec will be used.\r\n\r\nBasic example:\r\n\r\n```javascript\r\nRepeat(function() { console.log(\"W00t\"); })\r\n  .every(1, 's')\r\n  .for(20, 's')\r\n  .start.now()\r\n  .then(function() {\r\n    console.log(\"I'm done w00t'n\");\r\n  });\r\n```\r\n\r\n## Error handling and promise callbacks\r\n\r\n- Any errors thrown in the task function will cause the promise to be rejected with the error object as value\r\n- The promise's progress listeners be notified after each task invocation with the returned value as parameter\r\n- When done, the promise will be resolved with an array of the tasks return value for each invocation\r\n\r\nThe following example illustrates use of success/progress/error listeners:\r\n\r\n```javascript\r\nvar onSuccess = function(results) {\r\n  console.log(\"All good\", results);\r\n};\r\nvar onFailure = function(exception) {\r\n  console.error(\"Error\", exception);\r\n};\r\nvar onProgress = function(result) {\r\n  console.log(\"Progress: \", result);\r\n};\r\nRepeat(function() {\r\n        var v = Math.random();\r\n        if (v > 0.8) throw new Error(\"Ouch!\");\r\n        return v;\r\n    })\r\n  .every(1, 's')\r\n  .for(10, 's')\r\n  .start()\r\n  .then(onSuccess, onFailure, onProgress);\r\n```\r\n\r\nIf used standalone or with jQuery, the promise object also provides more convenient `progress` and `fail` functions for adding callbacks in separate steps.\r\nAdditionaly, there's also an `always` method to add callback functions for whenever the promise is either resolved or rejected.\r\n\r\nThe above example using the jQuery or standalone version could be written like this:\r\n\r\n```javascript\r\nvar repeat = Repeat(function() {\r\n        var v = Math.random();\r\n        if (v > 0.8) throw new Error(\"Ouch!\");\r\n        return v;\r\n    })\r\n  .every(1, 's')\r\n  .for(5, 's')\r\n  .start();\r\n\r\nrepeat.then(function() { console.log('Resolved!'); });\r\nrepeat.fail(function() { console.log('Rejected!'); });\r\nrepeat.always(function() { console.log('Done! (either resolved or rejected)'); });\r\n```\r\n\r\n## Compatibility notes\r\n\r\n- If you are targeting older browsers, you probably want to use any of the ECMAScript 5 polyfill libraries\r\nlisted here: https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills (in particular\r\n [ddr-ecma5](http://code.google.com/p/ddr-ecma5/), [augmentjs](http://augmentjs.com/) or\r\n  [es5-shim](https://github.com/kriskowal/es5-shim/))\r\n\r\n- Some older browsers and environments (IE 6 - 8) doesn't support using reserved words\r\nas property names (and may throw an error when referencing functions like \"for\", \"while\" and \"in\"),\r\nRepeat.js offers alternative function names for code targeted for such environments:\r\n\r\n  - `for`   => `lasting`\r\n  - `while` => `during`\r\n  - `in`    => `wait`\r\n  - `if`    => `provided`\r\n\r\nExample:\r\n\r\n```javascript\r\nRepeat(function() {\r\n  console.log(\"I'm safe\");\r\n })\r\n .every(2, 'sec')\r\n .lasting(2, 'min')                                   // lasting instead of for\r\n .during(function() { return Math.random() > .5; })   // during instead of while\r\n .provided(function() { return Math.random() > .5; }) // provided instead of if\r\n .wait(5, 'sec');                                     // wait instead of in\r\n```\r\n\r\nAnother less readable (and not recommended) workaround would be to reference these methods using bracket notation:\r\n\r\n```javascript\r\nRepeat(function() { console.log(\"Hello\"); })\r\n.every(2, 's')\r\n['for'](2, 'm')\r\n['if'](function() { return Math.random() > .5; })\r\n['while'](function() {  return Math.random() > .5; })\r\n['in'](5, 's');\r\n```\r\n\r\n# License\r\nCopyright (C) 2012 Bjørge Næss\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}